<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{site.title}} | {{page.title}}</title>
  <script type="text/javascript" src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  {% if page.layout == "post" %}
  <link rel="stylesheet" href="{{site.baseurl}}/assets/css/post.css" />
  <link rel="stylesheet" href="{{site.baseurl}}/assets/css/syntax.css" />
  {% else if page.layout == "blog" %}
  <link rel="stylesheet" href="{{site.baseurl}}/assets/css/blog.css" />
  {% else %}}
  <link rel="stylesheet" href="{{site.baseurl}}/assets/css/blog.css" />
  <link rel="stylesheet" href="{{site.baseurl}}/assets/css/login.css" />
  {%endif%}
  <link rel="stylesheet" href="{{site.baseurl}}/assets/css/common.css" />
  <script src="{{site.baseurl}}/assets/js/categories.js"></script>
  {% if page.layout == "post" %}
  <script defer src="{{site.baseurl}}/assets/js/lbox.js"></script>
  {% endif %}
  <script>
    let token = '';
    let logged_in = false;

    async function started() {

      logged_in = netlifyIdentity.currentUser() != null;
      netlifyIdentity.on('init', async user => {
        if(user) {
          token = user.token.access_token;
          logged_in = true;
        }
      })

      netlifyIdentity.on('login', user => {
        if(user) {
          logged_in = true;
          token = user.token.access_token;
        }
      })

      netlifyIdentity.on('logout', () => {
        token = '';
        logged_in = false;
      })
    }
    started()
  </script>
</head>
